{
  writeAMF3();
  buf.put(AMF3.TYPE_ARRAY);
  if (hasReference(array)) {
    putInteger(getReferenceId(array) << 1);
    return;
  }
  storeReference(array);
  amf3_mode+=1;
  putInteger(1);
  int idx=0;
  for (  Object item : array) {
    if (item != null) {
      putString(String.valueOf(idx));
      serializer.serialize(this,item);
    }
    idx++;
  }
  amf3_mode-=1;
  putString("");
}
