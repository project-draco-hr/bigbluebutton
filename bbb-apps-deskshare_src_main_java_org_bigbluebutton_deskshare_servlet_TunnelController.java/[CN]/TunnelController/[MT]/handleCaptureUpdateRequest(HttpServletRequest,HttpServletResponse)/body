{
  MultipartHttpServletRequest multipartRequest=(MultipartHttpServletRequest)request;
  MultipartFile multipartFile=multipartRequest.getFile("tile");
  byte[] tile=multipartFile.getBytes();
  InputStream imageData=new ByteArrayInputStream(tile);
  BufferedImage image=ImageIO.read(imageData);
  log.debug("Received tile size {}",tile.length);
  String room=request.getParameterValues("room")[0];
  log.debug("Received image from room {}",room);
  String tileInfo=request.getParameterValues("tileInfo")[0];
  log.debug("Received image from tileInfo {}",tileInfo);
  String[] tileDesc=tileInfo.split("x");
  int width=Integer.parseInt(tileDesc[0]);
  int height=Integer.parseInt(tileDesc[1]);
  int x=Integer.parseInt(tileDesc[2]);
  int y=Integer.parseInt(tileDesc[3]);
  int pos=Integer.parseInt(tileDesc[4]);
  if (!hasGateway) {
    streamerGateway=getStreamerGateway();
    hasGateway=true;
  }
  CaptureUpdateEvent event=new CaptureUpdateEvent(image,room,width,height,x,y,pos);
  streamerGateway.onCaptureEvent(event);
}
