{
  String dataPut="";
  int inEscape=0;
  int inQuotes=0;
  char[] startChars=start.toCharArray();
  for (  char startChar : startChars) {
    if (inEscape != 0) {
      dataPut+=startChar;
      inEscape=0;
    }
 else {
      if (startChar == '\\') {
        inEscape=1;
      }
 else       if (startChar == '\'') {
        inQuotes=1 - inQuotes;
      }
 else {
        dataPut+=inQuotes != 0 ? startChar : ((startChar == find) ? replace_with : startChar);
      }
    }
  }
  return dataPut;
}
