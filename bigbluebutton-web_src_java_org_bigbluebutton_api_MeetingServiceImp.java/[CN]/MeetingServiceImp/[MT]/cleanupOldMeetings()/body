{
  log.debug("Cleaning out old conferences");
  for (  Meeting conf : meetings.values()) {
    boolean remove=false;
    if (conf.isRunning()) {
      log.debug("Meeting [" + conf.getMeetingID() + "] is running - not cleaning it out");
      continue;
    }
    long now=System.currentTimeMillis();
    long millisSinceStored=conf.getStoredTime() == null ? -1 : (now - conf.getStoredTime().getTime());
    long millisSinceEnd=conf.getEndTime() == null ? -1 : (now - conf.getEndTime().getTime());
    if (conf.getStartTime() != null && millisSinceEnd > (minutesElapsedBeforeMeetingExpiration * 60000)) {
      log.debug("Removing meeting because it started, ended, and is past the max expiration");
      remove=true;
    }
 else     if (conf.getEndTime() == null && millisSinceStored > (minutesElapsedBeforeMeetingExpiration * 60000)) {
      log.debug("Removing meeting because it was stored, but never started [stored " + millisSinceStored + " millis ago]");
      remove=true;
    }
    if (remove) {
      log.debug("Removing meeting [" + conf.getMeetingToken() + "]");
      meetings.remove(conf.getMeetingID());
    }
 else {
      log.debug("Not removing meeting [" + conf.getMeetingID() + "]");
    }
  }
}
