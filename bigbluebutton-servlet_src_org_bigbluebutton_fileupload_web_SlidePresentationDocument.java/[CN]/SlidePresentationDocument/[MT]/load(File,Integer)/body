{
  if ((uploaded.getName().toLowerCase().endsWith(".pdf")) || (uploaded.getName().toLowerCase().endsWith(".ppt"))) {
    this.uploadedFile=uploaded;
    this.room=room;
    destDir=new File(slideManager.getBaseDirectory() + File.separator + room+ File.separator+ slideManager.getExtractedFolder());
    if (destDir.exists()) {
      log.info("Directroy not empty = [" + destDir.getAbsolutePath() + "]- deleting");
      File[] files=destDir.listFiles();
      for (int i=0; i < files.length; i++) {
        files[i].delete();
      }
    }
 else {
      destDir.mkdirs();
    }
    log.info("Loading file from [" + uploadedFile.getName() + "]");
    DocumentLoader loader=new DocumentLoader();
    Thread docLoader=new Thread(loader,"Document Loader");
    docLoader.start();
  }
 else {
    updatesMsgSender.sendMessage(room,ReturnCode.WRONG_FORMAT,"Unsupported file type.");
    throw new UnsupportedPresentationDocumentException("Unsupported file type.");
  }
}
