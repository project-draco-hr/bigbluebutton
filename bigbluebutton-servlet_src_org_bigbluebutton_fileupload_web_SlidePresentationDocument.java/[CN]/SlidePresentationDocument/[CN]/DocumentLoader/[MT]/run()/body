{
  try {
    if (uploadedFile.getName().toLowerCase().endsWith(".pdf")) {
      pdfToSwfHandler.convert(room,uploadedFile,destDir);
    }
 else     if (uploadedFile.getName().toLowerCase().endsWith(".ppt")) {
      updatesMsgSender.sendMessage(room,ReturnCode.UPDATE,"Converting Powerpoint document.");
      pptToSwfHandler.convert(room,uploadedFile,destDir);
    }
 else {
      log.error("Unsupported File.");
      updatesMsgSender.sendMessage(room,ReturnCode.WRONG_FORMAT,"Unsupported file type.");
      return;
    }
    ArrayList<File> generatedFiles=new ArrayList<File>(0);
    log.info("Loading slides from '" + destDir + "'.");
    generatedFiles=slideManager.getExtractedSlides(destDir.getAbsolutePath());
    if (generatedFiles.size() < 1) {
      if (log.isErrorEnabled()) {
        log.error("Failed to generate slides.");
      }
      return;
    }
    String slidesXml=slideManager.createXml(room);
    updatesMsgSender.sendMessage(room,ReturnCode.SUCCESS,slidesXml);
  }
 catch (  Exception e) {
    if (log.isErrorEnabled()) {
      log.error("Could not load document: \n ");
      e.printStackTrace();
    }
  }
}
