{
  final String actionId;
  String internalActionId;
  SendActionCallback listener;
  if (response == null) {
    logger.error("Unable to dispatch null response. This should never happen. Please file a bug.");
    return;
  }
  actionId=response.getActionId();
  internalActionId=null;
  listener=null;
  if (actionId != null) {
    internalActionId=ManagerUtil.getInternalActionId(actionId);
    response.setActionId(ManagerUtil.stripInternalActionId(actionId));
  }
  logger.debug("Dispatching response with internalActionId '" + internalActionId + "':\n"+ response);
  if (internalActionId != null) {
synchronized (this.responseListeners) {
      listener=responseListeners.get(internalActionId);
      if (listener != null) {
        this.responseListeners.remove(internalActionId);
      }
 else {
        logger.debug("No response listener registered for " + "internalActionId '" + internalActionId + "'");
      }
    }
  }
 else {
    logger.error("Unable to retrieve internalActionId from response: " + "actionId '" + actionId + "':\n"+ response);
  }
  if (listener != null) {
    try {
      listener.onResponse(response);
    }
 catch (    Exception e) {
      logger.warn("Unexpected exception in response listener " + listener.getClass().getName(),e);
    }
  }
}
