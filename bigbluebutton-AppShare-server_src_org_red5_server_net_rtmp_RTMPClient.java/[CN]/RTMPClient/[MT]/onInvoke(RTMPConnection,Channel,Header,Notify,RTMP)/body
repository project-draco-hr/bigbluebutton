{
  final IServiceCall call=invoke.getCall();
  if (call.getServiceMethodName().equals("_result") || call.getServiceMethodName().equals("_error")) {
    handlePendingCallResult(conn,invoke);
    return;
  }
  if (serviceProvider == null) {
    call.setStatus(Call.STATUS_METHOD_NOT_FOUND);
    call.setException(new MethodNotFoundException(call.getServiceMethodName()));
  }
 else {
    serviceInvoker.invoke(call,serviceProvider);
  }
  if (call instanceof IPendingServiceCall) {
    IPendingServiceCall psc=(IPendingServiceCall)call;
    Object result=psc.getResult();
    if (result instanceof DeferredResult) {
      DeferredResult dr=(DeferredResult)result;
      dr.setInvokeId(invoke.getInvokeId());
      dr.setServiceCall(psc);
      dr.setChannel(channel);
      conn.registerDeferredResult(dr);
    }
 else {
      Invoke reply=new Invoke();
      reply.setCall(call);
      reply.setInvokeId(invoke.getInvokeId());
      channel.write(reply);
    }
  }
}
