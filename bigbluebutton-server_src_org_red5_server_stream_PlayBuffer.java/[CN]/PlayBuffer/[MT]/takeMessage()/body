{
  RTMPMessage message=messageQueue.poll();
  if (message != null) {
    IRTMPEvent body=message.getBody();
    if (!(body instanceof IStreamData)) {
      throw new RuntimeException("expected IStreamData but got " + body);
    }
    messageSize-=((IStreamData)body).getData().limit();
  }
  return message;
}
