{
  String filename=file.getAbsolutePath() + ".meta";
  File metadataFile=new File(filename);
  if (!metadataFile.exists())   return null;
  Document dom;
  DocumentBuilderFactory dbf=DocumentBuilderFactory.newInstance();
  try {
    DocumentBuilder db=dbf.newDocumentBuilder();
    dom=db.parse(filename);
  }
 catch (  ParserConfigurationException pce) {
    log.error("Could not parse XML file.",pce);
    return null;
  }
catch (  SAXException se) {
    log.error("Could not parse XML file.",se);
    return null;
  }
catch (  IOException ioe) {
    log.error("Could not parse XML file.",ioe);
    return null;
  }
  Element root=dom.getDocumentElement();
  if (!"FrameMetadata".equals(root.getNodeName()))   return null;
  String modified=root.getAttribute("modified");
  if (modified == null || !modified.equals(String.valueOf(file.lastModified())))   return null;
  if (!root.hasAttribute("duration"))   return null;
  if (!root.hasAttribute("audioOnly"))   return null;
  XPathFactory factory=XPathFactory.newInstance();
  XPath xpath=factory.newXPath();
  NodeList keyFrames;
  try {
    XPathExpression xexpr=xpath.compile("/FrameMetadata/KeyFrame");
    keyFrames=(NodeList)xexpr.evaluate(dom,XPathConstants.NODESET);
  }
 catch (  XPathExpressionException err) {
    log.error("could not compile xpath expression",err);
    return null;
  }
  int length=keyFrames.getLength();
  if (keyFrames == null || length == 0)   return null;
  KeyFrameMeta result=new KeyFrameMeta();
  result.duration=Long.parseLong(root.getAttribute("duration"));
  result.positions=new long[length];
  result.timestamps=new int[length];
  for (int i=0; i < length; i++) {
    Node node=keyFrames.item(i);
    NamedNodeMap attrs=node.getAttributes();
    result.positions[i]=Long.parseLong(attrs.getNamedItem("position").getNodeValue());
    result.timestamps[i]=Integer.parseInt(attrs.getNamedItem("timestamp").getNodeValue());
  }
  result.audioOnly="true".equals(root.getAttribute("audioOnly"));
  return result;
}
