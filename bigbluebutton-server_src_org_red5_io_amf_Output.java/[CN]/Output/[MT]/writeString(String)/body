{
  final byte[] encoded=encodeString(string);
  final int len=encoded.length;
  if (len < AMF.LONG_STRING_LENGTH) {
    buf.put(AMF.TYPE_STRING);
    buf.putShort((short)len);
  }
 else {
    buf.put(AMF.TYPE_LONG_STRING);
    buf.putInt(len);
  }
  buf.put(encoded);
}
