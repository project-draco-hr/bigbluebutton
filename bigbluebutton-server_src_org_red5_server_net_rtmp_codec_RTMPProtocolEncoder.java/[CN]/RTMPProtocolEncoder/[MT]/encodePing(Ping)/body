{
  int len=6;
  if (ping.getValue3() != Ping.UNDEFINED) {
    len+=4;
  }
  if (ping.getValue4() != Ping.UNDEFINED) {
    len+=4;
  }
  final ByteBuffer out=ByteBuffer.allocate(len);
  out.putShort(ping.getValue1());
  out.putInt(ping.getValue2());
  if (ping.getValue3() != Ping.UNDEFINED) {
    out.putInt(ping.getValue3());
  }
  if (ping.getValue4() != Ping.UNDEFINED) {
    out.putInt(ping.getValue4());
  }
  return out;
}
