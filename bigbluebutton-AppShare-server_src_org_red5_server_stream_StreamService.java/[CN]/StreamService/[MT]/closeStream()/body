{
  IConnection conn=Red5.getConnectionLocal();
  if (!(conn instanceof IStreamCapableConnection)) {
    return;
  }
  IClientStream stream=((IStreamCapableConnection)conn).getStreamById(getCurrentStreamId());
  if (stream != null) {
    if (stream instanceof IClientBroadcastStream) {
      IClientBroadcastStream bs=(IClientBroadcastStream)stream;
      IBroadcastScope bsScope=getBroadcastScope(conn.getScope(),bs.getPublishedName());
      if (bsScope != null && conn instanceof BaseConnection) {
        ((BaseConnection)conn).unregisterBasicScope(bsScope);
      }
    }
    stream.close();
  }
  ((IStreamCapableConnection)conn).deleteStreamById(getCurrentStreamId());
}
