{
  if (!dontStop) {
    IConnection conn=Red5.getConnectionLocal();
    if (!(conn instanceof IStreamCapableConnection)) {
      return;
    }
    IStreamCapableConnection streamConn=(IStreamCapableConnection)conn;
    int streamId=getCurrentStreamId();
    IClientStream stream=streamConn.getStreamById(streamId);
    if (!(stream instanceof IBroadcastStream)) {
      return;
    }
    IBroadcastStream bs=(IBroadcastStream)stream;
    if (bs.getPublishedName() == null) {
      return;
    }
    IBroadcastScope bsScope=getBroadcastScope(conn.getScope(),bs.getPublishedName());
    if (bsScope != null) {
      bsScope.unsubscribe(bs.getProvider());
      if (conn instanceof BaseConnection) {
        ((BaseConnection)conn).unregisterBasicScope(bsScope);
      }
    }
    bs.close();
    streamConn.deleteStreamById(streamId);
  }
}
