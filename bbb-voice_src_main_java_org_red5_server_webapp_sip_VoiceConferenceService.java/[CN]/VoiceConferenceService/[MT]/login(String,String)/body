{
  log.debug("Red5SIP login " + uid);
  IConnection conn=Red5.getConnectionLocal();
  IServiceCapableConnection service=(IServiceCapableConnection)conn;
  SIPUser sipUser=sipManager.getSIPUser(uid);
  if (sipUser == null) {
    log.debug("Red5SIP open creating sipUser for " + username + " on sip port "+ sipPort+ " audio port "+ rtpPort+ " uid "+ uid);
    try {
      sipUser=new SIPUser(conn.getClient().getId(),service,sipPort,rtpPort);
      sipManager.addSIPUser(uid,sipUser);
    }
 catch (    Exception e) {
      log.error("open error " + e);
    }
  }
  String password="secret";
  String realm=asteriskHost;
  String proxy=realm;
  sipUser.login(proxy,new Integer(rtpPort).toString(),username,password,realm,proxy);
  userNames.put(conn.getClient().getId(),uid);
  sipPort++;
  if (sipPort > stopSIPPort)   sipPort=startSIPPort;
  rtpPort++;
  if (rtpPort > stopRTPPort)   rtpPort=startRTPPort;
}
