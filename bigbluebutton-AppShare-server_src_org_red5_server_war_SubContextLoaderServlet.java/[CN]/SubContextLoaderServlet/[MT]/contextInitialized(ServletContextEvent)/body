{
  if (null != servletContext) {
    return;
  }
  System.setProperty("red5.deployment.type","war");
  servletContext=sce.getServletContext();
  String prefix=servletContext.getRealPath("/");
  initRegistry(servletContext);
  long time=System.currentTimeMillis();
  logger.info("RED5 Server subcontext loader");
  logger.debug("Path: " + prefix);
  try {
    String[] configArray=servletContext.getInitParameter(ContextLoader.CONFIG_LOCATION_PARAM).split("[,\\s]");
    logger.debug("Config location files: " + configArray.length);
    WebSettings settings=new WebSettings();
    settings.setPath(prefix);
    String[] subConfigs=new String[configArray.length];
    for (int s=0; s < configArray.length; s++) {
      String cfg="file:/" + prefix + configArray[s];
      logger.debug("Sub config location: " + cfg);
      subConfigs[s]=cfg;
    }
    settings.setConfigs(subConfigs);
    settings.setWebAppKey(servletContext.getInitParameter("webAppRootKey"));
    IRemotableList remote=null;
    boolean firstReg=false;
    try {
      remote=(IRemotableList)Naming.lookup("rmi://localhost:" + rmiPort + "/subContextList");
    }
 catch (    Exception e) {
      logger.warn("Lookup failed: " + e.getMessage());
    }
    if (remote == null) {
      remote=new RemotableList();
      firstReg=true;
    }
    logger.debug("Adding child web settings");
    remote.addChild(settings);
    logger.debug("Remote list size: " + remote.numChildren());
    if (firstReg) {
      Naming.bind("rmi://localhost:" + rmiPort + "/subContextList",remote);
    }
 else {
      Naming.rebind("rmi://localhost:" + rmiPort + "/subContextList",remote);
    }
  }
 catch (  Throwable t) {
    logger.error("",t);
  }
  long startupIn=System.currentTimeMillis() - time;
  logger.info("Startup done in: " + startupIn + " ms");
}
