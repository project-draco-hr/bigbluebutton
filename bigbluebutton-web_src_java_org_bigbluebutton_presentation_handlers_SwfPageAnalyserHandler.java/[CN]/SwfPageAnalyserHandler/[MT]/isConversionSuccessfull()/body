{
  if (exitCode == 0) {
    int matches=StringUtils.countMatches(stdoutBuilder.toString(),DEFINE_SHAPE3);
    matches*=0.5;
    log.debug("Defined shapes in the SWF " + matches);
    if (matches > maxSwfShapes) {
      log.error("SWF contains too much Shapes defined, the maximum allowed number is " + maxSwfShapes);
      return false;
    }
    return true;
  }
 else {
    String reason="The SWF is not compliant due to an unknown error";
    if (stdoutContains(FONT_NULL_GLYPH)) {
      reason="SWF contains invalid font glyph dfintion";
    }
 else     if (stdoutContains(SYMBOL_REDEFINED)) {
      reason="A SWF symbol was defined twice";
    }
 else     if (stderrContains(MALFORMED_URL)) {
      reason="The SWF contains a malformed URL, the parsed file does probably not exist";
    }
 else     if (stderrContains(DEFINE_BUTTON)) {
      reason="A SWF DefineButton tag could not be parsed";
    }
    log.error("swfdump exited with an error on file [" + analysedFile.getAbsolutePath() + "]\nReason => "+ reason+ "\nstderr:\n"+ stderrBuilder.toString());
    return false;
  }
}
