{
  IScope scope=root;
  if (path == null) {
    return scope;
  }
  final String[] parts=path.split("/");
  for (  String room : parts) {
    if (room.equals("")) {
      continue;
    }
    if (scope.hasChildScope(room)) {
      scope=scope.getScope(room);
    }
 else     if (!scope.equals(root)) {
synchronized (scope) {
        if (scope.hasChildScope(room)) {
          scope=scope.getScope(room);
        }
 else         if (scope.createChildScope(room)) {
          scope=scope.getScope(room);
        }
 else {
          throw new ScopeNotFoundException(scope,room);
        }
      }
    }
 else {
      throw new ScopeNotFoundException(scope,room);
    }
    if (scope instanceof WebScope && ((WebScope)scope).isShuttingDown()) {
      throw new ScopeShuttingDownException(scope);
    }
  }
  return scope;
}
