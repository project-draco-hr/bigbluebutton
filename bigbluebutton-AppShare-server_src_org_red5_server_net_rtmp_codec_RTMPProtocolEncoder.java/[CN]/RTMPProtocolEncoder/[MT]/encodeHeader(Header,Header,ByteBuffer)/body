{
  final byte headerType=getHeaderType(header,lastHeader);
  RTMPUtils.encodeHeaderByte(buf,headerType,header.getChannelId());
switch (headerType) {
case HEADER_NEW:
    RTMPUtils.writeMediumInt(buf,header.getTimer());
  RTMPUtils.writeMediumInt(buf,header.getSize());
buf.put(header.getDataType());
RTMPUtils.writeReverseInt(buf,header.getStreamId());
break;
case HEADER_SAME_SOURCE:
RTMPUtils.writeMediumInt(buf,header.getTimer());
RTMPUtils.writeMediumInt(buf,header.getSize());
buf.put(header.getDataType());
break;
case HEADER_TIMER_CHANGE:
RTMPUtils.writeMediumInt(buf,header.getTimer());
break;
case HEADER_CONTINUE:
break;
default :
}
}
