{
  if (aspectRatio) {
    recalculateScaleDimensionsToMaintainAspectRatio();
  }
  capture=new ScreenCapture(x,y,captureWidth,captureHeight,scaleWidth,scaleHeight,quality);
  captureTaker=new ScreenCaptureTaker(capture);
  mTaker=new MouseLocationTaker(captureWidth,captureHeight,scaleWidth,scaleHeight,x,y);
  Dimension screenDim=new Dimension(scaleWidth,scaleHeight);
  Dimension tileDim=new Dimension(blockWidth,blockHeight);
  blockManager=new BlockManager();
  blockManager.addListener(this);
  blockManager.initialize(screenDim,tileDim);
  sender=new NetworkStreamSender(blockManager,host,port,room,screenDim,tileDim,httpTunnel);
  connected=sender.connect();
  if (connected) {
    sender.addNetworkConnectionListener(this);
    captureTaker.addListener(this);
    captureTaker.start();
    captureTakerThread=new Thread(captureTaker,"ScreenCaptureTaker");
    captureTakerThread.start();
    sender.start();
    mTaker.start();
    mouseLocationTakerThread=new Thread(mTaker,"MouseLocationTakerThread");
    mTaker.addListener(this);
    mouseLocationTakerThread.start();
  }
 else {
    notifyListener(ExitCode.DESKSHARE_SERVICE_UNAVAILABLE);
  }
}
