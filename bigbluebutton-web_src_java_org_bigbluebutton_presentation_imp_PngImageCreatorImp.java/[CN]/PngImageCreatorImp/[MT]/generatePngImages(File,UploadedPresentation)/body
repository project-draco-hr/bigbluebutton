{
  String source=pres.getUploadedFile().getAbsolutePath();
  String dest;
  String COMMAND="";
  boolean done=true;
  if (SupportedFileTypes.isImageFile(pres.getFileType())) {
    dest=imagePresentationDir.getAbsolutePath() + File.separator + "slide1.png";
    COMMAND=IMAGEMAGICK_DIR + "/convert " + source+ " "+ dest;
    done=new ExternalProcessExecutor().exec(COMMAND,60000);
  }
 else {
    for (int i=1; i <= pres.getNumberOfPages(); i++) {
      File tmp=new File(imagePresentationDir.getAbsolutePath() + File.separatorChar + "tmp"+ File.separatorChar+ "slide"+ i+ ".pdf");
      File destpng=new File(imagePresentationDir.getAbsolutePath() + File.separatorChar + "slide"+ i+ ".png");
      COMMAND=IMAGEMAGICK_DIR + "/convert -density 300x300 -quality 90 +dither -depth 8 -colors 256 " + File.separatorChar+ tmp.getAbsolutePath()+ " "+ destpng.getAbsolutePath();
      done=new ExternalProcessExecutor().exec(COMMAND,60000);
      if (!done) {
        break;
      }
    }
  }
  if (done) {
    return true;
  }
  log.warn("Failed to create png images: " + COMMAND);
  return false;
}
