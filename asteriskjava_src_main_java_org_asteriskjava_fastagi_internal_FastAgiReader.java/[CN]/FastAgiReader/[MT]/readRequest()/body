{
  AgiRequestImpl request;
  String line;
  List<String> lines;
  lines=new ArrayList<String>();
  try {
    while ((line=socket.readLine()) != null) {
      if (line.length() == 0) {
        break;
      }
      lines.add(line);
    }
  }
 catch (  IOException e) {
    throw new AgiNetworkException("Unable to read request from Asterisk: " + e.getMessage(),e);
  }
  request=new AgiRequestImpl(lines);
  request.setLocalAddress(socket.getLocalAddress());
  request.setLocalPort(socket.getLocalPort());
  request.setRemoteAddress(socket.getRemoteAddress());
  request.setRemotePort(socket.getRemotePort());
  return request;
}
