{
  if (!isClosing())   return;
  if (buffer != null) {
    buffer.release();
    buffer=null;
  }
  notifyMessages.clear();
  state.setState(RTMP.STATE_DISCONNECTED);
  super.close();
  for (  ByteBuffer buf : pendingMessages) {
    buf.release();
  }
  pendingMessages.clear();
  if (servlet != null) {
    servlet.notifyClosed(this);
    servlet=null;
  }
}
