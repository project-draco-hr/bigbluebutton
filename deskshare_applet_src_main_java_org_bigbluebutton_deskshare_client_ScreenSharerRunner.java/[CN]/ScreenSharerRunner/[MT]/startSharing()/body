{
  printHeader();
  captureTaker=new ScreenCaptureTaker(ssi.x,ssi.y,ssi.captureWidth,ssi.captureHeight,ssi.scaleWidth,ssi.scaleHeight,ssi.quality);
  mouseLocTaker=new MouseLocationTaker(ssi.captureWidth,ssi.captureHeight,ssi.scaleWidth,ssi.scaleHeight,ssi.x,ssi.y);
  Dimension screenDim=new Dimension(ssi.scaleWidth,ssi.scaleHeight);
  Dimension tileDim=new Dimension(blockWidth,blockHeight);
  blockManager=new BlockManager();
  blockManager.initialize(screenDim,tileDim);
  sender=new NetworkStreamSender(blockManager,ssi.host,ssi.port,ssi.room,screenDim,tileDim,ssi.httpTunnel);
  connected=sender.connect();
  if (connected) {
    ChangedBlocksListener changedBlocksListener=new ChangedBlockListenerImp(sender);
    blockManager.addListener(changedBlocksListener);
    ScreenCaptureListener screenCapListener=new ScreenCaptureListenerImp(blockManager);
    captureTaker.addListener(screenCapListener);
    captureTaker.start();
    sender.start();
    MouseLocationListenerImp mouseLocListener=new MouseLocationListenerImp(sender,ssi.room);
    mouseLocTaker.addListener(mouseLocListener);
    mouseLocTaker.start();
  }
 else {
    notifyListener(ExitCode.DESKSHARE_SERVICE_UNAVAILABLE);
  }
}
