{
  if (message.getType().equals(ClientMessage.BROADCAST)) {
    IScope scope=scopes.get(message.getDest());
    if (scope != null) {
      List<Object> params=new ArrayList<Object>();
      params.add(message.getMessageName());
      params.add(message.getMessage());
      ServiceUtils.invokeOnAllScopeConnections(scope,"onMessageFromServer",params.toArray(),null);
    }
  }
 else   if (message.getType().equals(ClientMessage.DIRECT)) {
    IConnection conn=connections.get(message.getDest());
    if (conn != null) {
      if (conn.isConnected()) {
        List<Object> params=new ArrayList<Object>();
        params.add(message.getMessageName());
        params.add(message.getMessage());
        ServiceUtils.invokeOnConnection(conn,"onMessageFromServer",params.toArray());
      }
    }
  }
}
