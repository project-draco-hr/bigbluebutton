{
  byte type=in.readDataType();
  while (type == DataTypes.CORE_SKIP) {
    type=in.readDataType();
  }
  if (log.isDebugEnabled()) {
    log.debug("Datatype: " + DataTypes.toStringValue(type));
  }
  Object result;
switch (type) {
case DataTypes.CORE_NULL:
    result=in.readNull();
  break;
case DataTypes.CORE_BOOLEAN:
result=in.readBoolean();
break;
case DataTypes.CORE_NUMBER:
result=in.readNumber();
break;
case DataTypes.CORE_STRING:
result=in.readString();
break;
case DataTypes.CORE_DATE:
result=in.readDate();
break;
case DataTypes.CORE_ARRAY:
result=in.readArray(this);
break;
case DataTypes.CORE_MAP:
result=in.readMap(this);
break;
case DataTypes.CORE_XML:
result=in.readXML();
break;
case DataTypes.CORE_OBJECT:
result=in.readObject(this);
break;
case DataTypes.CORE_BYTEARRAY:
result=in.readByteArray();
break;
case DataTypes.OPT_REFERENCE:
result=in.readReference();
break;
default :
result=in.readCustom();
break;
}
return (T)postProcessExtension(result,target);
}
