{
  this.room=room;
  updatesMsgSender.sendMessage(room,ReturnCode.UPDATE,"Generating slides.");
  extractPages(fileSource,destDir);
  ArrayList<File> files=getConvertedSlides(destDir.toString());
  int curSlide=1;
  for (Iterator<File> it=files.iterator(); it.hasNext(); ) {
    File aFile=(File)it.next();
    String fname=aFile.getName();
    System.out.println("Filename = [" + fname + "]");
    int dot=fname.lastIndexOf('.');
    fname=fname.substring(0,dot);
    fname+=".swf";
    File outFile=new File(aFile.getParent() + File.separator + fname);
    System.out.println("Input = [" + aFile.getAbsolutePath() + "]");
    System.out.println("Output = [" + outFile.getAbsolutePath() + "]");
    convertPDFtoSWF(aFile,outFile);
    updatesMsgSender.sendMessage(room,ReturnCode.CONVERT,files.size(),curSlide++);
  }
}
