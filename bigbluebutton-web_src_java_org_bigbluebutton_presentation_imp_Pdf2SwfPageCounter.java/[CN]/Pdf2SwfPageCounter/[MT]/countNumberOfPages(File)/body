{
  int numPages=0;
  String COMMAND=SWFTOOLS_DIR + "/pdf2swf -I " + presentationFile.getAbsolutePath();
  try {
    Process p=Runtime.getRuntime().exec(COMMAND);
    BufferedReader stdInput=new BufferedReader(new InputStreamReader(p.getInputStream()));
    BufferedReader stdError=new BufferedReader(new InputStreamReader(p.getErrorStream()));
    String info;
    Matcher matcher;
    while ((info=stdInput.readLine()) != null) {
      matcher=PAGE_NUMBER_PATTERN.matcher(info);
      if (matcher.matches()) {
        numPages=Integer.valueOf(matcher.group(1).trim()).intValue();
      }
    }
    while ((info=stdError.readLine()) != null) {
      log.error(info);
    }
    stdInput.close();
    stdError.close();
    int exitValue=p.waitFor();
    if (exitValue != 0) {
      log.warn("Exit Value != 0 while for " + COMMAND);
    }
  }
 catch (  IOException e) {
    log.error("IOException while processing " + COMMAND);
  }
catch (  InterruptedException e) {
    log.error("InterruptedException while processing " + COMMAND);
  }
  return numPages;
}
