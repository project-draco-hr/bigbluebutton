def main():
    presentationSrcDir = ''
    pdfFilename = ''
    try:
        (opts, args) = getopt.getopt(sys.argv[1:], 'hp:f:', ['help', 'presentation-dir=', 'pdf-filename='])
    except getopt.GetoptError as err:
        print str(err)
        usage()
        sys.exit(2)
    for (o, a) in opts:
        if (o in ('-h', '--help')):
            usage()
            sys.exit()
        elif (o in ('-p', '--presentation-dir')):
            presentationSrcDir = a
        elif (o in ('-f', '--pdf-filename')):
            pdfFilename = a
        else:
            assert False, 'unhandled option'
    printUsage = False
    if (presentationSrcDir == ''):
        print 'Missing presentation dir.'
        printUsage = True
    if (pdfFilename == ''):
        print 'Missing pdf filename.'
        printUsage = True
    if printUsage:
        printUsageHelp()
    numPages = determine_number_of_pages(presentationSrcDir)
    if (numPages > 0):
        i = 1
        while (i <= numPages):
            extract_page_from_pdf(i, ((presentationSrcDir + '/') + pdfFilename), presentationSrcDir)
            fileToConvert = ((presentationSrcDir + '/slide-') + str(i))
            convert_pdf_to_png((fileToConvert + '.pdf'), (fileToConvert + '.png'))
            i += 1
