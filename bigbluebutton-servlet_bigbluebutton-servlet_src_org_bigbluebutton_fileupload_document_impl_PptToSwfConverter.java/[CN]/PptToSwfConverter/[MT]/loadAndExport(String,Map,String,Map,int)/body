{
  XComponentLoader desktop=openOfficeConnection.getDesktop();
  XComponent document=desktop.loadComponentFromURL(inputUrl,"_blank",0,toPropertyValues(loadProperties));
  if (document == null) {
    updatesMsgSender.sendMessage(room,ReturnCode.FILE_NOT_FOUND,"Cannot load the document.");
    logger.error("Cannot load document from [" + inputUrl + "]");
    throw new OpenOfficeException("conversion failed: input document is null after loading");
  }
  refreshDocument(document);
  int numPages=PageHelper.getDrawPageCount(document);
  document=removePagesExcept(document,page,numPages);
  storeProperties.put("URL",outputUrl);
  try {
    XStorable saveDoc=(XStorable)UnoRuntime.queryInterface(XStorable.class,document);
    saveDoc.storeToURL(outputUrl,toPropertyValues(storeProperties));
  }
  finally {
    document.dispose();
  }
}
