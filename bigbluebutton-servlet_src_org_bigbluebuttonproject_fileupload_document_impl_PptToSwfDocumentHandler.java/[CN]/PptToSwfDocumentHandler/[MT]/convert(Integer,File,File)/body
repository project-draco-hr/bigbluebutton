{
  OpenOfficeConnection connection=new SocketOpenOfficeConnection(openOfficeHost,openOfficePort);
  try {
    logger.info("-- connecting to OpenOffice.org on port " + openOfficePort);
    updatesMsgSender.sendMessage(room,ReturnCode.UPDATE,"Connecting to OpenOffice server.");
    connection.connect();
  }
 catch (  ConnectException officeNotRunning) {
    logger.error("ERROR: connection failed. Please make sure OpenOffice is running and listening on port " + openOfficePort + ".");
    updatesMsgSender.sendMessage(room,ReturnCode.OO_CONNECTION,"Cannot connect to OpenOffice.");
  }
  try {
    updatesMsgSender.sendMessage(room,ReturnCode.UPDATE,"Successfully connected to OpenOffice server.");
    DocumentConverter converter=new PptToSwfConverter(updatesMsgSender,room,connection);
    File outputFile=new File(destDir.getAbsolutePath() + File.separator + "output.pdf");
    ((PptToSwfConverter)converter).setSwftoolConverter(swftoolConverter);
    converter.convert(fileSource,outputFile);
  }
  finally {
    logger.info("-- disconnecting");
    connection.disconnect();
  }
}
