{
  if (buf == null) {
    log.error("Why is buf null?");
  }
  currentDataType=buf.get();
  byte coreType;
  if (currentDataType == AMF.TYPE_AMF3_OBJECT) {
    currentDataType=buf.get();
  }
 else   if (amf3_mode == 0) {
    return readDataType(currentDataType);
  }
switch (currentDataType) {
case AMF3.TYPE_NULL:
    coreType=DataTypes.CORE_NULL;
  break;
case AMF3.TYPE_INTEGER:
case AMF3.TYPE_NUMBER:
coreType=DataTypes.CORE_NUMBER;
break;
case AMF3.TYPE_BOOLEAN_TRUE:
case AMF3.TYPE_BOOLEAN_FALSE:
coreType=DataTypes.CORE_BOOLEAN;
break;
case AMF3.TYPE_STRING:
coreType=DataTypes.CORE_STRING;
break;
case AMF3.TYPE_XML:
case AMF3.TYPE_XML_SPECIAL:
coreType=DataTypes.CORE_XML;
break;
case AMF3.TYPE_OBJECT:
coreType=DataTypes.CORE_OBJECT;
break;
case AMF3.TYPE_ARRAY:
coreType=DataTypes.CORE_ARRAY;
break;
case AMF3.TYPE_DATE:
coreType=DataTypes.CORE_DATE;
break;
case AMF3.TYPE_BYTEARRAY:
coreType=DataTypes.CORE_BYTEARRAY;
break;
default :
log.info("Unknown datatype: {}",currentDataType);
coreType=DataTypes.CORE_SKIP;
break;
}
return coreType;
}
